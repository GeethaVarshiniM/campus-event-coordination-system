import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.PrintWriter;

public ByteArrayInputStream generateCsvForEvent(Long eventId) {
    List<Registration> registrations = registrationRepository.findByEvent_Id(eventId);

    ByteArrayOutputStream out = new ByteArrayOutputStream();
    PrintWriter writer = new PrintWriter(out);

    // CSV header
    writer.println("Email,Register Number,Department,Phone");

    for (Registration r : registrations) {
        writer.println(
                r.getEmail() + "," +
                r.getRegNumber() + "," +
                r.getDepartment() + "," +
                r.getPhone()
        );
    }

    writer.flush();
    return new ByteArrayInputStream(out.toByteArray());
}
